contniue this!

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WhatsApp Chat Analyzer Pro</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="https://cdn.jsdelivr.net/npm/sentiment@5.0.2/build/sentiment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emoji-dictionary@1.0.3/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.1.2/src/wordcloud2.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    header {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
      padding: 40px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: 'üí¨';
      position: absolute;
      font-size: 200px;
      opacity: 0.1;
      top: -50px;
      right: -50px;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
    }

    .subtitle {
      font-size: 1.1em;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    .upload-section {
      padding: 30px;
      text-align: center;
      background: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
    }

    .file-input-wrapper {
      position: relative;
      display: inline-block;
    }

    input[type="file"] {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .upload-btn {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      color: white;
      padding: 15px 40px;
      border-radius: 50px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      display: inline-block;
      box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
    }

    .upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(37, 211, 102, 0.6);
    }

    .file-name {
      margin-top: 15px;
      font-size: 0.95em;
      color: #666;
      font-style: italic;
    }

    .tabs {
      display: flex;
      background: #f8f9fa;
      padding: 0 20px;
      overflow-x: auto;
      border-bottom: 2px solid #e9ecef;
    }

    .tab-btn {
      padding: 18px 30px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      color: #666;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
      white-space: nowrap;
    }

    .tab-btn:hover {
      color: #25D366;
      background: rgba(37, 211, 102, 0.05);
    }

    .tab-btn.active {
      color: #25D366;
      border-bottom-color: #25D366;
      background: white;
    }

    .tab-content {
      padding: 40px;
      display: none;
      animation: fadeIn 0.3s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .stat-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-card h3 {
      font-size: 0.9em;
      opacity: 0.9;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .stat-card .value {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stat-card .label {
      font-size: 0.85em;
      opacity: 0.8;
    }

    .chart-container {
      background: white;
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 1px solid #e9ecef;
    }

    .chart-container h3 {
      margin-bottom: 20px;
      color: #333;
      font-size: 1.3em;
      padding-bottom: 10px;
      border-bottom: 2px solid #25D366;
    }

    canvas {
      max-width: 100%;
      height: auto !important;
    }

    #wordcloud {
      width: 100%;
      height: 400px;
      border: 1px solid #e9ecef;
      border-radius: 10px;
      background: white;
    }

    .info-box {
      background: #d1ecf1;
      color: #0c5460;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      border-left: 4px solid #17a2b8;
    }

    .info-box h4 {
      margin-bottom: 10px;
    }

    .info-box ul {
      margin-left: 20px;
    }

    /* Game Styles */
    .game-container {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      color: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .game-message {
      background: rgba(255,255,255,0.2);
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      font-size: 1.1em;
      line-height: 1.6;
      backdrop-filter: blur(10px);
    }

    .game-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .game-btn {
      padding: 15px 25px;
      background: white;
      color: #333;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .game-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .game-btn.correct {
      background: #43e97b;
      color: white;
    }

    .game-btn.incorrect {
      background: #f5576c;
      color: white;
    }

    .game-score {
      text-align: center;
      font-size: 1.5em;
      font-weight: bold;
      margin: 15px 0;
    }

    .game-controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 20px;
    }

    .prediction-card {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 20px;
      color: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .prediction-card h4 {
      font-size: 1.3em;
      margin-bottom: 15px;
      opacity: 0.95;
    }

    .prediction-value {
      font-size: 2em;
      font-weight: bold;
      margin: 10px 0;
    }

    .prediction-details {
      font-size: 0.9em;
      opacity: 0.9;
      line-height: 1.6;
    }

    .relationship-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .relationship-card {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 1px solid #e9ecef;
    }

    .relationship-card h4 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.1em;
    }

    .relationship-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .relationship-item:last-child {
      border-bottom: none;
    }

    .relationship-label {
      font-weight: 600;
      color: #555;
    }

    .relationship-value {
      color: #25D366;
      font-weight: bold;
      font-size: 1.1em;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 1.8em;
      }
      
      .tabs {
        padding: 0 10px;
      }
      
      .tab-btn {
        padding: 15px 20px;
        font-size: 0.9em;
      }
      
      .tab-content {
        padding: 20px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }

      .game-options {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üí¨ WhatsApp Chat Analyzer Pro</h1>
      <p class="subtitle">Discover insights from your conversations</p>
    </header>

    <div class="upload-section">
      <div class="file-input-wrapper">
        <label class="upload-btn">
          üìÅ Choose WhatsApp Chat File
          <input type="file" id="fileInput" accept=".txt" />
        </label>
      </div>
      <div class="file-name" id="fileName"></div>
    </div>

    <div class="tabs">
      <button class="tab-btn active" onclick="showTab('overview')">üìä Overview</button>
      <button class="tab-btn" onclick="showTab('activity')">‚è∞ Activity</button>
      <button class="tab-btn" onclick="showTab('users')">üë• Users</button>
      <button class="tab-btn" onclick="showTab('relationships')">üíï Relationships</button>
      <button class="tab-btn" onclick="showTab('predictions')">üîÆ Predictions</button>
      <button class="tab-btn" onclick="showTab('game')">üéÆ Game</button>
      <button class="tab-btn" onclick="showTab('content')">üí≠ Content</button>
    </div>

    <div id="overview" class="tab-content" style="display:block;">
      <div class="info-box">
        <h4>How to export your WhatsApp chat:</h4>
        <ul>
          <li>Open WhatsApp and go to the chat you want to analyze</li>
          <li>Tap the three dots (‚ãÆ) > More > Export chat</li>
          <li>Choose "Without Media" and save the .txt file</li>
          <li>Upload the file here to see amazing insights!</li>
        </ul>
      </div>
      <div id="overviewContent"></div>
    </div>

    <div id="activity" class="tab-content"></div>
    <div id="users" class="tab-content"></div>
    <div id="relationships" class="tab-content"></div>
    <div id="predictions" class="tab-content"></div>
    <div id="game" class="tab-content"></div>
    <div id="content" class="tab-content"></div>
  </div>

  <script>
    let chartInstances = [];
    let globalData = null;
    let gameState = {
      currentQuestion: 0,
      score: 0,
      answered: false,
      questions: []
    };

    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      document.getElementById('fileName').textContent = `Selected: ${file.name}`;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          analyzeChat(e.target.result);
        } catch (error) {
          showError('Error analyzing chat: ' + error.message);
        }
      };
      reader.readAsText(file);
    });

    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(div => div.style.display = 'none');
      document.getElementById(tabName).style.display = 'block';
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function showError(message) {
      document.getElementById('overviewContent').innerHTML = 
        `<div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 10px; margin: 20px; border: 1px solid #f5c6cb;"><strong>Error:</strong> ${message}</div>`;
    }

    function destroyCharts() {
      chartInstances.forEach(chart => chart.destroy());
      chartInstances = [];
    }

    function analyzeChat(text) {
      destroyCharts();
      
      const lines = text.split('\n');
      const pattern = /^(\d{1,2}\/\d{1,2}\/\d{2,4}),?\s(\d{1,2}:\d{2})\s?[-‚Äì]\s([^:]+):\s(.*)$/;
      const data = [];

      lines.forEach(line => {
        const match = line.match(pattern);
        if (match) {
          const [_, date, time, user, message] = match;
          const parts = date.split('/');
          const dateObj = new Date(parts[2], parts[1] - 1, parts[0]);
          dateObj.setHours(...time.split(':'));
          data.push({ datetime: dateObj, user: user.trim(), message });
        }
      });

      if (data.length === 0) {
        showError('No messages found. Please check your file format.');
        return;
      }

      globalData = data;

      generateOverview(data);
      generateActivity(data);
      generateUsers(data);
      generateRelationships(data);
      generatePredictions(data);
      generateGame(data);
      generateContent(data);
    }

    function generateOverview(data) {
      const users = [...new Set(data.map(d => d.user))];
      const dates = data.map(d => d.datetime);
      const firstDate = new Date(Math.min(...dates));
      const lastDate = new Date(Math.max(...dates));
      const daysDiff = Math.ceil((lastDate - firstDate) / (1000 * 60 * 60 * 24));
      
      const totalWords = data.reduce((sum, d) => sum + d.message.split(/\s+/).filter(Boolean).length, 0);
      const avgWordsPerMsg = (totalWords / data.length).toFixed(1);
      
      const mediaCount = data.filter(d => d.message.includes('omitted') || d.message.includes('Media')).length;
      
      const userCounts = {};
      data.forEach(d => userCounts[d.user] = (userCounts[d.user] || 0) + 1);

      const html = `
        <div class="stats-grid">
          <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h3>Total Messages</h3>
            <div class="value">${data.length.toLocaleString()}</div>
            <div class="label">${(data.length / daysDiff).toFixed(1)} per day</div>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <h3>Participants</h3>
            <div class="value">${users.length}</div>
            <div class="label">${users.join(', ')}</div>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <h3>Duration</h3>
            <div class="value">${daysDiff}</div>
            <div class="label">days of conversation</div>
          </div>
          <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
            <h3>Total Words</h3>
            <div class="value">${totalWords.toLocaleString()}</div>
            <div class="label">${avgWordsPerMsg} avg per message</div>
          </div>
        </div>

        <div class="chart-container">
          <h3>üì± Message Distribution</h3>
          <canvas id="overviewPie"></canvas>
        </div>

        <div class="chart-container">
          <h3>üìà Messages Over Time</h3>
          <canvas id="overviewTimeline"></canvas>
        </div>
      `;

      document.getElementById('overviewContent').innerHTML = html;

      const ctx1 = document.getElementById('overviewPie').getContext('2d');
      chartInstances.push(new Chart(ctx1, {
        type: 'doughnut',
        data: {
          labels: Object.keys(userCounts),
          datasets: [{
            data: Object.values(userCounts),
            backgroundColor: ['#667eea', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#feca57']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'bottom' }
          }
        }
      }));

      const dailyData = {};
      data.forEach(d => {
        const day = d.datetime.toISOString().slice(0, 10);
        dailyData[day] = (dailyData[day] || 0) + 1;
      });
      
      const ctx2 = document.getElementById('overviewTimeline').getContext('2d');
      chartInstances.push(new Chart(ctx2, {
        type: 'line',
        data: {
          labels: Object.keys(dailyData).sort(),
          datasets: [{
            label: 'Messages per Day',
            data: Object.values(dailyData),
            borderColor: '#667eea',
            backgroundColor: 'rgba(102, 126, 234, 0.1)',
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          }
        }
      }));
    }

    function generateActivity(data) {
      const hourCounts = new Array(24).fill(0);
      data.forEach(d => hourCounts[d.datetime.getHours()]++);

      const weekdayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      const weekdayCounts = new Array(7).fill(0);
      data.forEach(d => weekdayCounts[d.datetime.getDay()]++);

      const heatmap = Array(7).fill(null).map(() => Array(24).fill(0));
      data.forEach(d => {
        heatmap[d.datetime.getDay()][d.datetime.getHours()]++;
      });

      const html = `
        <div class="chart-container">
          <h3>‚è∞ Messages by Hour of Day</h3>
          <canvas id="activityHour"></canvas>
        </div>

        <div class="chart-container">
          <h3>üìÖ Messages by Day of Week</h3>
          <canvas id="activityWeekday"></canvas>
        </div>

        <div class="chart-container">
          <h3>üî• Activity Heatmap</h3>
          <canvas id="activityHeatmap"></canvas>
        </div>
      `;

      document.getElementById('activity').innerHTML = html;

      const ctx1 = document.getElementById('activityHour').getContext('2d');
      chartInstances.push(new Chart(ctx1, {
        type: 'bar',
        data: {
          labels: Array.from({length: 24}, (_, i) => `${i}:00`),
          datasets: [{
            label: 'Messages',
            data: hourCounts,
            backgroundColor: 'rgba(67, 233, 123, 0.7)'
          }]
        },
        options: { responsive: true }
      }));

      const ctx2 = document.getElementById('activityWeekday').getContext('2d');
      chartInstances.push(new Chart(ctx2, {
        type: 'bar',
        data: {
          labels: weekdayNames,
          datasets: [{
            label: 'Messages',
            data: weekdayCounts,
            backgroundColor: 'rgba(79, 172, 254, 0.7)'
          }]
        },
        options: { responsive: true }
      }));

      const ctx3 = document.getElementById('activityHeatmap').getContext('2d');
      const datasets = weekdayNames.map((day, i) => ({
        label: day,
        data: heatmap[i],
        backgroundColor: `hsla(${i * 50}, 70%, 60%, 0.7)`
      }));
      
      chartInstances.push(new Chart(ctx3, {
        type: 'bar',
        data: {
          labels: Array.from({length: 24}, (_, i) => `${i}:00`),
          datasets: datasets
        },
        options: {
          responsive: true,
          scales: {
            x: { stacked: true },
            y: { stacked: true }
          }
        }
      }));
    }

    function generateUsers(data) {
      const userStats = {};
      data.forEach(d => {
        if (!userStats[d.user]) {
          userStats[d.user] = {
            messages: 0,
            words: 0,
            avgLength: [],
            emojis: 0
          };
        }
        userStats[d.user].messages++;
        const words = d.message.split(/\s+/).filter(Boolean).length;
        userStats[d.user].words += words;
        userStats[d.user].avgLength.push(d.message.length);
        
        if (window.emojiDictionary) {
          for (const char of d.message) {
            if (window.emojiDictionary.getName(char)) {
              userStats[d.user].emojis++;
            }
          }
        }
      });

      const users = Object.keys(userStats);
      const html = `
        <div class="chart-container">
          <h3>üí¨ Messages per User</h3>
          <canvas id="usersMessages"></canvas>
        </div>

        <div class="chart-container">
          <h3>üìù Words per User</h3>
          <canvas id="usersWords"></canvas>
        </div>

        <div class="chart-container">
          <h3>üòä Emoji Usage</h3>
          <canvas id="usersEmojis"></canvas>
        </div>
      `;

      document.getElementById('users').innerHTML = html;

      const ctx1 = document.getElementById('usersMessages').getContext('2d');
      chartInstances.push(new Chart(ctx1, {
        type: 'bar',
        data: {
          labels: users,
          datasets: [{
            label: 'Messages',
            data: users.map(u => userStats[u].messages),
            backgroundColor: 'rgba(102, 126, 234, 0.7)'
          }]
        },
        options: { responsive: true }
      }));

      const ctx2 = document.getElementById('usersWords').getContext('2d');
      chartInstances.push(new Chart(ctx2, {
        type: 'bar',
        data: {
          labels: users,
          datasets: [{
            label: 'Total Words',
            data: users.map(u => userStats[u].words),
            backgroundColor: 'rgba(240, 147, 251, 0.7)'
          }]
        },
        options: { responsive: true }
      }));

      const ctx3 = document.getElementById('usersEmojis').getContext('2d');
      chartInstances.push(new Chart(ctx3, {
        type: 'bar',
        data: {
          labels: users,
          datasets: [{
            label: 'Emojis Used',
            data: users.map(u => userStats[u].emojis),
            backgroundColor: 'rgba(255, 193, 7, 0.7)'
          }]
        },
        options: { responsive: true }
      }));
    }
  function generateRelationships(data) {
    const pairs = {};
    for (let i = 0; i < data.length - 1; i++) {
      const sender = data[i].user;
      const receiver = data[i + 1].user;
      if (sender !== receiver) {
        const key = [sender, receiver].sort().join(' & ');
        pairs[key] = (pairs[key] || 0) + 1;
      }
    }

    const sortedPairs = Object.entries(pairs).sort((a,b) => b[1] - a[1]).slice(0,5);

    let html = '<div class="relationship-grid">';
    sortedPairs.forEach(([pair, count]) => {
      html += `
        <div class="relationship-card">
          <h4>Top Pair</h4>
          <div class="relationship-item">
            <span class="relationship-label">${pair}</span>
            <span class="relationship-value">${count} replies</span>
          </div>
        </div>`;
    });
    html += '</div>';

    document.getElementById('relationships').innerHTML = html;
  }

  function generatePredictions(data) {
    const userCounts = {};
    data.forEach(d => userCounts[d.user] = (userCounts[d.user] || 0) + 1);
    const topUser = Object.entries(userCounts).sort((a,b)=>b[1]-a[1])[0];

    const avgPerDay = (data.length / 
      ((Math.max(...data.map(d=>d.datetime)) - Math.min(...data.map(d=>d.datetime))) / (1000*60*60*24))
    ).toFixed(1);

    const html = `
      <div class="prediction-card">
        <h4>Most Active User Prediction</h4>
        <div class="prediction-value">${topUser[0]}</div>
        <div class="prediction-details">with ${topUser[1]} messages</div>
      </div>
      <div class="prediction-card">
        <h4>Expected Future Activity</h4>
        <div class="prediction-value">${avgPerDay} msgs/day</div>
        <div class="prediction-details">based on past activity trends</div>
      </div>
    `;
    document.getElementById('predictions').innerHTML = html;
  }

  function generateGame(data) {
    const userCounts = {};
    data.forEach(d => userCounts[d.user] = (userCounts[d.user] || 0) + 1);
    const users = Object.keys(userCounts);

    const questions = [];
    for (let i=0; i<5; i++) {
      const sample = data[Math.floor(Math.random()*data.length)];
      questions.push({
        message: sample.message,
        correct: sample.user,
        options: shuffle(users.slice(0,3).concat(sample.user))
      });
    }
    gameState.questions = questions;
    gameState.currentQuestion = 0;
    gameState.score = 0;
    renderGame();
  }

  function renderGame() {
    const q = gameState.questions[gameState.currentQuestion];
    if (!q) {
      document.getElementById('game').innerHTML = 
        `<div class="game-container"><h3>Game Over!</h3>
         <div class="game-score">Final Score: ${gameState.score}/${gameState.questions.length}</div></div>`;
      return;
    }

    let html = `<div class="game-container">
      <h3>Who said this?</h3>
      <div class="game-message">"${q.message}"</div>
      <div class="game-options">`;

    q.options.forEach(opt => {
      html += `<button class="game-btn" onclick="answerGame('${opt}')">${opt}</button>`;
    });

    html += `</div><div class="game-score">Score: ${gameState.score}</div></div>`;
    document.getElementById('game').innerHTML = html;
  }

  function answerGame(selected) {
    const q = gameState.questions[gameState.currentQuestion];
    const buttons = document.querySelectorAll('.game-btn');
    buttons.forEach(btn => {
      if (btn.textContent === q.correct) btn.classList.add('correct');
      if (btn.textContent === selected && selected !== q.correct) btn.classList.add('incorrect');
      btn.disabled = true;
    });
    if (selected === q.correct) gameState.score++;
    setTimeout(() => {
      gameState.currentQuestion++;
      renderGame();
    }, 1500);
  }

  function shuffle(array) {
    return array.sort(() => Math.random()-0.5);
  }

  function generateContent(data) {
    const sentiment = new Sentiment();
    const allText = data.map(d=>d.message).join(" ");
    const words = allText.split(/\s+/).filter(w => w.length>3);

    const counts = {};
    words.forEach(w => counts[w.toLowerCase()] = (counts[w.toLowerCase()] || 0)+1);
    const topWords = Object.entries(counts).sort((a,b)=>b[1]-a[1]).slice(0,100);

    const score = sentiment.analyze(allText).score;

    const html = `
      <div class="chart-container">
        <h3>üìù Wordcloud</h3>
        <div id="wordcloud"></div>
      </div>
      <div class="chart-container">
        <h3>üí° Sentiment Score</h3>
        <p style="font-size:1.5em;">${score > 0 ? "üòä Positive" : score < 0 ? "‚òπ Negative" : "üòê Neutral"} (${score})</p>
      </div>
    `;
    document.getElementById('content').innerHTML = html;

    WordCloud(document.getElementById('wordcloud'), {
      list: topWords,
      gridSize: 10,
      weightFactor: 2,
      color: () => `hsl(${Math.random()*360},70%,60%)`,
      rotateRatio: 0.3
    });
  }
</script>
